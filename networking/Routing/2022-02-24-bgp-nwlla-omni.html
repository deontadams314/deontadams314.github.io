<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!--
    The page_title contains the title for a page as shown in the navigation.
    Site name contains the name as defined in the mkdocs.yml
  -->
  <title>BGP - N WLLA OMNI - unknown-networks</title>

  <!-- Page description -->
  

  <!-- Redirect -->
  
    <link rel="canonical" href="https://unknown-networks.com/networking/Routing/2022-02-24-bgp-nwlla-omni.html" />
  

  <!-- Page author -->
  
    <meta name="author" content="dta314" />
  
  <!--
    Just add a favicon.ico image to the docs.
  -->
  <link rel="shortcut icon" href="../../img/favicon.ico">

  <link rel="stylesheet" href="../../css/colors.css">
  <link rel="stylesheet" href="../../css/bundle.css">
  <link rel="stylesheet" href="../../css/theme.css">
  <link media="print" onload="this.media='all'" rel="stylesheet" href="../../css/atom-dark-one.min.css">
  <!--
    extra_ess contains paths to CSS files in the users
    documentation directory or a list of CSS files defined in
    their mkdocs.yml.

    http://www.mkdocs.org/user-guide/configuration/#extra_css
  -->
  

  
  

  <!--
    Include Google Analytics tracking code.

    http://www.mkdocs.org/user-guide/configuration/#google_analytics
  -->
  

</head>

<body>
<input id="dark-mode" type="checkbox" />
<!--
  The JS has to be loaded here for maximum performance, right after the #dark-mode
-->
<script src="../../js/theme.js"></script>
<div class="app-body">
  <!-- KPN STYLE Beginning -->
  <div class="app-layout ">
    <!-- Top Bar -->
    <nav class="app-layout__top-bar top-bar">
      <a class="top-bar__logo">
        <img alt="KPN Logo" src="../../img/logo-kpn.svg" />
      </a>
      <div class="top-bar__title">unknown-networks</div>
      <ul class="top-bar__menu">
        <!--
          Create a search form that sends the user to the search.html file - this is
          the other file in the template which adds search to the theme. The only
          requirement here is that there is a text input with the name 'q' and the
          action and methods match below.
        -->
          <li class="top-bar__item">

            <span role="search" id="search-input-wrapper">
              <form action="../../search.html" method="get">
                <input type="text" class="input" id="search-input" name="q" placeholder="Search..." />
              </form>
            </span >
          </li>
        <!--
          Versioning support
        -->
        
        <!--
          Support repo URL
        -->
        <li class="top-bar__item">
          
        </li>

        <li class="top-bar__item">
            <label class="top-bar__link" id="label-dark-mode" for="dark-mode" title="Dark mode">
              <svg alt="dark mode" width="24" height="24">
                <image xlink:href="../../img/ui-bulb.svg" width="24" height="24"/>
            </svg>
            </label>
        </li>
        <li class="top-bar__item top-bar__item--trigger"></li>

        <!-- <li class="top-bar__item">

          <a class="top-bar__link top-bar__link--active">Home</a>
        </li>
        <li class="top-bar__item"><a class="top-bar__link">Information</a></li>
        <li class="top-bar__item">
          <a class="top-bar__link top-bar__link--collapsed">Getting Started</a>

        </li>
        <li class="top-bar__item top-bar__item--trigger">Menu</li> -->
      </ul>
    </nav>

    <!--
      Create the navigation for the documentation.

      Because we don't know how many levels deep the navigation is, it needs to
      be included in it's own file so it can be recursive. Otherwise the theme
      can also only support a specific number of levels.

      See the nav.html file for more details about how this works.
    -->
    <nav class="app-layout__side-bar side-bar">
      <div class="side-bar__action-bar">
        <a class="side-bar__link" href="/">unknown-networks</a>
        <!--
          Versioning support
        -->
        
        <button class="side-bar__close"></button>
      </div>
      <ul class="side-bar__menu">
        
          <!--

-->

<li>
  <a href="../../welcome.html" class="side-bar__link ">
    Welcome
  </a>
</li>

        
          <!--

-->

  <li>
    <span class="side-bar__link side-bar__link--expanded side-bar__link--active">
      Networking
    </span>
    <ul class="side-bar__sub-menu side-bar__sub-menu--visible">
        
            <!--

-->

  <li>
    <span class="side-bar__link side-bar__link--collapsed">
      General
    </span>
    <ul class="side-bar__sub-menu ">
        
            <!--

-->

<li>
  <a href="../General/2022-02-15-all-about-arp.html" class="side-bar__link ">
    All About ARP
  </a>
</li>

        
            <!--

-->

<li>
  <a href="../General/2022-02-26-planes-data-control-management.html" class="side-bar__link ">
    Planes: Control, Data, Management
  </a>
</li>

        
            <!--

-->

<li>
  <a href="../General/2022-02-28-stp.html" class="side-bar__link ">
    STP: Spanning Tree Protocol 8012.1D
  </a>
</li>

        
    </ul>
  </li>

        
            <!--

-->

  <li>
    <span class="side-bar__link side-bar__link--expanded side-bar__link--active">
      Routing
    </span>
    <ul class="side-bar__sub-menu side-bar__sub-menu--visible">
        
            <!--

-->

<li>
  <a href="2022-01-27-bgp-states.html" class="side-bar__link ">
    BGP States
  </a>
</li>

        
            <!--

-->

<li>
  <a href="2022-01-31-bgp-path-attributes.html" class="side-bar__link ">
    BGP Path Attributes
  </a>
</li>

        
            <!--

-->

<li>
  <a href="2022-02-02-ibgp.html" class="side-bar__link ">
    Internal BGP - iBGP
  </a>
</li>

        
            <!--

-->

<li>
  <a href="2022-02-04-route-reflectors-confederations.html" class="side-bar__link ">
    Route Reflectors And Confederations
  </a>
</li>

        
            <!--

-->

<li>
  <a href="2022-02-06-ospf-neighbor-states.html" class="side-bar__link ">
    OSPF Neighbor States
  </a>
</li>

        
            <!--

-->

<li>
  <a href="2022-02-18-ospf-loop-prevention.html" class="side-bar__link ">
    OSPF Loop Prevention
  </a>
</li>

        
            <!--

-->

<li>
  <a href="2022-02-24-bgp-nwlla-omni.html" class="side-bar__link side-bar__link--active">
    BGP - N WLLA OMNI
  </a>
</li>

        
            <!--

-->

<li>
  <a href="2022-03-01-routing-loops-prev.html" class="side-bar__link ">
    Split Horizon/Posion Reverse/Route Poisoning
  </a>
</li>

        
    </ul>
  </li>

        
            <!--

-->

  <li>
    <span class="side-bar__link side-bar__link--collapsed">
      TCP IP
    </span>
    <ul class="side-bar__sub-menu ">
        
            <!--

-->

<li>
  <a href="../TCP-IP/2022-01-20-tcp-the-handshake.html" class="side-bar__link ">
    TCP - The Handshake
  </a>
</li>

        
            <!--

-->

<li>
  <a href="../TCP-IP/2022-01-30-tcp-halfclose-halfopen.html" class="side-bar__link ">
    TCP - Half-Close And Half-Open
  </a>
</li>

        
            <!--

-->

<li>
  <a href="../TCP-IP/2022-02-07-tcp-window.html" class="side-bar__link ">
    The TCP Window
  </a>
</li>

        
    </ul>
  </li>

        
    </ul>
  </li>

        
          <!--

-->

  <li>
    <span class="side-bar__link side-bar__link--collapsed">
      Security
    </span>
    <ul class="side-bar__sub-menu ">
        
            <!--

-->

  <li>
    <span class="side-bar__link side-bar__link--collapsed">
      General
    </span>
    <ul class="side-bar__sub-menu ">
        
            <!--

-->

<li>
  <a href="../../security/General/2022-04-10-how-tls-works.html" class="side-bar__link ">
    How TLS Works
  </a>
</li>

        
    </ul>
  </li>

        
            <!--

-->

  <li>
    <span class="side-bar__link side-bar__link--collapsed">
      Network Security
    </span>
    <ul class="side-bar__sub-menu ">
        
            <!--

-->

<li>
  <a href="../../security/Network-Security/2022-04-18-netsec-vlan-hopping.html" class="side-bar__link ">
    VLAN Hopping
  </a>
</li>

        
            <!--

-->

<li>
  <a href="../../security/Network-Security/2022-04-19-netsec-arp-spoofing.html" class="side-bar__link ">
    ARP Spoofing
  </a>
</li>

        
            <!--

-->

<li>
  <a href="../../security/Network-Security/2022-04-20-netsec-ddos-attacks.html" class="side-bar__link ">
    DDoS Attacks
  </a>
</li>

        
            <!--

-->

<li>
  <a href="../../security/Network-Security/2022-04-25-netsec-dns-spoofing.html" class="side-bar__link ">
    DNS Spoofing
  </a>
</li>

        
    </ul>
  </li>

        
    </ul>
  </li>

        
      </ul>
    </nav>

    <!-- MAIN BLOCK -->
    <main class="app-layout__main main">
      <div class="app-layout__title-bar title-bar">
        <div class="title-bar__title">BGP - N WLLA OMNI</div>
      </div>
      
      <div class="sidebar--secondary hidden-s hidden-xs">
        <h4>Table of contents</h4>
        <ul>
        
          
            
                <li><a class="a" href="#the-decision-process">The Decision Process</a></li>
                
            
                <li><a class="a" href="#tiebreaker-steps">Tiebreaker Steps</a></li>
                
            
                <li><a class="a" href="#n-wlla-omni">N WLLA OMNI</a></li>
                
            
                <li><a class="a" href="#key-things-to-note">Key Things to Note</a></li>
                
            
          
        
        </ul>
      </div>
      
      <div class="container content-block">
        <div class="kpn-style">
          <div class="card">
            <div class="card__body">

              
              <h1 id="bgp-n-wlla-omni"><strong>BGP - N WLLA OMNI</strong><a class="headerlink" href="#bgp-n-wlla-omni" title="Permanent link">#</a></h1>
<p>I know what your thinking, N WLLA OMNI, is that weird dive bar that I should know about? No, N WLLA OMNI is the acronym for the BGP decision process. When a BGP router has multiple routes to an NLRI it must choose the best path to the NLRI. To figure out the best path this is where N WLLA OMNI comes into play. It is a rather deep system BGP uses to choose the best path. Here we will discuss the decision process in detail so it can become easier to understand and remember.</p>
<h2 id="the-decision-process">The Decision Process<a class="headerlink" href="#the-decision-process" title="Permanent link">#</a></h2>
<p>There are 9 total steps in the decision process with 3 additional tie-breaker steps. Let's take a look and see how BGP decides the best route to an NLRI when multiples exist.</p>
<p>1) Is the NEXT_HOP reachable?: If a router does not have a route next to the NEXT_HOP path atrribute, the route should then be rejected.</p>
<p>2) Highest Weight: Weight is a Cisco propriety feature so you will most likely not see this on other vendors. This attribute it set locally on the router to the NLRI and is not advertised to other routers. The higher the Weight the better the route.</p>
<p>3) Highest LOCAL_PREF: The higher the LOCAL_PREF the better the route. This is a well-known discretionary path attribute and is only used in iBGP. This attribute does not leave the AS and all routers within the AS can configure this attribute to choose the same exit route to an NLRI.</p>
<p>4) Locally Injected Routes: Choose the route locally injected into BGP (via network cmd, summarization or redistribution). Better than iBGP/eBGP learned routes.</p>
<p>5) Shortest AS_PATH length: AS_PATH is the attribute that shows the AS numbers that the NLRI has passed through. The shorter the AS_PATH the better the route.</p>
<p>6) ORIGIN attribute: IGP routes (I) are preferred over EGP (E) routes. Which is then preferred over incomplete (?) routes, You should rarely see EGP routes being BGP is the successor to EGP.</p>
<p>7) Smallest MED attribute:  The smaller the MED value the better the route. The MED attribute is an optional transitive attribute. Typically a sender will use MED to tell a receiving peer with multiple connections to them the better pathway to an NLRI. </p>
<p>8) Neighbor Type: eBGP routes are preferred over iBGP routes. Confedration eBGP routes are treated as equal to iBGP.</p>
<p>9) IGP metric for reaching the NEXT_HOP: Compare the IGP metrics of the NEXT_HOP of an NLRI. The lower the metric the better the route.</p>
<h2 id="tiebreaker-steps">Tiebreaker Steps<a class="headerlink" href="#tiebreaker-steps" title="Permanent link">#</a></h2>
<p>If a best path is not determined after going through steps 1-9, 3 tiebreaker steps are used to find the best path to a NLRI. They are as follows:</p>
<p>10) Keeps the oldest eBGP route. If the routes being compared are eBGP routes  and one of the paths is currently the best path, then keep that route as the best path.</p>
<p>11) Choose the route whose next-hop router ID (RID) is the smallest.</p>
<p>12) Choose the smallest neighbor ID. If a router has at least two neighbor connections with a single router, the router will prefer the route advertised by the lowest neighbor ID listed in the routers neighbor commands.</p>
<h2 id="n-wlla-omni">N WLLA OMNI<a class="headerlink" href="#n-wlla-omni" title="Permanent link">#</a></h2>
<p>The bread and better of the post and what we all have been waiting for. Here is the acronym used to help memorize this 9 step decision process.</p>
<ul>
<li>
<p>NEXT_HOP reachable?</p>
</li>
<li>
<p>WEIGHT</p>
</li>
<li>LOCAL_PREF</li>
<li>Locally Injected</li>
<li>
<p>AS_PATH length</p>
</li>
<li>
<p>ORIGIN</p>
</li>
<li>MED</li>
<li>Neighbor Type</li>
<li>IGP Metric to NEXT_HOP</li>
</ul>
<h2 id="key-things-to-note">Key Things to Note<a class="headerlink" href="#key-things-to-note" title="Permanent link">#</a></h2>
<ul>
<li>
<p>The decision process is only used to find one best path to reach an NLRI. It is not used to find multiple equal routes to install them into the routing table.</p>
</li>
<li>
<p>If a step determines the best route the process ends at that step and does not move forward. For example, if LOCAL_PREF determines the best path it will not look at locally injected routes or AS_PATH.</p>
</li>
</ul>
              
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- FOOTER -->
    <footer class="footer">
      <div class="footer__body">
        
        <div class="row">
          <div class="col col--s-4 col--m-3 col--l-2">
          </div>
          <div class="col col--s-4 col--m space-between">
            
              <a class="footer__link padding-top-0 navigation-prev"
                href="2022-02-18-ospf-loop-prevention.html"
                title="OSPF Loop Prevention">
                &#8592; Previous Page
              </a>
            
            
            
              <a class="footer__link padding-top-0 navigation-next"
                href="2022-03-01-routing-loops-prev.html"
                title="Split Horizon/Posion Reverse/Route Poisoning"/>
                Next Page &#8594;
              </a>
            
          </div>
          <div class="col col--s-4 col--m-3 ">
          </div>
        </div>
        
      </div>
    </footer>
  </div>


  <!--
  MkDocs version      : 1.6.1
  Docs Build Date UTC : 2025-02-23 21:14:46.538485+00:00
  -->

  <!--
    To include static assets from our theme, just add
    ../.. beforehand which will be the relative path to
    the root of the documentation.
  -->
  <script src="../../js/highlight.min.js"></script>
  <script src="../../js/languages/groovy.min.js"></script>
  <script src="../../js/languages/asciidoc.min.js"></script>
  <script src="../../js/languages/nix.min.js"></script>

  <script>
    hljs.highlightAll();
  </script>
  <script async src="../../js/detail.js"></script>
  <!--
    extra_javascript contains paths to JavaScript files in the
    users documentation directory or a list of JavaScript files
    defined in their mkdocs.yml.

    http://www.mkdocs.org/user-guide/configuration/#extra_javascript
  -->
  
    <script src="../../search/main.js"></script>
  


  <script>
  function getMermaidTheme() {
    if (document.getElementById("dark-mode").checked) {
      return 'dark'
    }
    return 'forest'
  }

  function initMermaid() {
    mermaid.initialize({
      theme: getMermaidTheme(),
      logLevel: 1,
    });
  }
  var mermaidClass = document.getElementsByClassName('mermaid');
  if (mermaidClass.length > 0) {

    var mermaidScript = document.createElement('script');
    mermaidScript.setAttribute("src", "../../js/mermaid.min.js");
    mermaidScript.setAttribute("async", "false");
    mermaidScript.setAttribute("type", "text/javascript");
    mermaidScript.onload = initMermaid;
    document.body.appendChild(mermaidScript)

  }
  </script>

</div>
</body>
</html>